# generate

Create files from templates by substituting environment variables.

## Synopsis

```bash
mulle-template generate [options] <template> [output]
```

## Description

The `generate` command creates files from templates by substituting keys enclosed in `<|KEY|>` with values from environment variables. It can process both single template files and entire template directories.

This command is useful for:
- Generating configuration files from templates
- Creating source code files with project-specific values
- Batch processing template directories
- Automated file generation in build scripts

## Options

| Option | Description |
|--------|-------------|
| `-h`, `--help` | Show help information |
| `-p`, `--permissions` | Copy file permissions from template |
| `--header-file <file>` | Specify file to replace <|HEADER|> with |
| `--footer-file <file>` | Specify file to replace <|FOOTER|> with |
| `--file <file>` | Only act on this file when copying directories |
| `-o <string>` | Specify key opener string (default: "<|") |
| `-c <string>` | Specify key closer string (default: "|>") |
| `-fo <string>` | Specify key opener string for filenames |
| `-fc <string>` | Specify key closer string for filenames |
| `--csed <seds>` | Sed expressions to use on template contents |
| `--fsed <seds>` | Sed expressions to use on template filenames |
| `--no-date-environment` | Don't create substitutions for TIME, YEAR etc. |
| `--boring-environment` | Don't filter out environment keys considered boring |
| `--with-template-dir` | Include template directory name in output path |
| `--without-template-dir` | Don't include template directory name in output path |
| `--overwrite` | Force overwrite of existing files |
| `--no-overwrite` | Don't overwrite existing files (default) |
| `--comment <text>` | Add comment to generated files |
| `--comment-start <text>` | Comment start marker |
| `--comment-middle <text>` | Comment middle marker |
| `--comment-end <text>` | Comment end marker |

## Examples

### Basic File Generation
```bash
# Generate a file from a template
mulle-template generate template.txt output.txt

# Generate to stdout
mulle-template generate template.txt -

# Use environment variables
export NAME="John Doe"
export PROJECT="MyApp"
mulle-template generate template.txt output.txt
```

### Directory Processing
```bash
# Generate entire directory
mulle-template generate template_dir/ output_dir/

# Generate with custom key markers
mulle-template generate -o "{{" -c "}}" template.txt output.txt

# Force overwrite existing files
mulle-template generate --overwrite template.txt output.txt
```

### Advanced Template Features
```bash
# Use header and footer files
mulle-template generate --header-file header.txt --footer-file footer.txt template.txt output.txt

# Add comments to generated files
mulle-template generate --comment "Generated by mulle-template" template.txt output.txt

# Custom comment markers
mulle-template generate --comment "Auto-generated" --comment-start "/*" --comment-end "*/" template.c output.c
```

### Environment Variable Control
```bash
# Include all environment variables (including "boring" ones)
mulle-template generate --boring-environment template.txt output.txt

# Exclude date/time variables
mulle-template generate --no-date-environment template.txt output.txt

# Use specific environment variables
NAME="Alice" EMAIL="alice@example.com" mulle-template generate template.txt output.txt
```

## Template Syntax

### Basic Substitution
```bash
# Template file content
Hello <|NAME|>, welcome to <|PROJECT|>!

# Environment variables
export NAME="John"
export PROJECT="MyApp"

# Result: Hello John, welcome to MyApp!
```

### Default Values
```bash
# Template with defaults
Hello <|NAME:-Anonymous|>, welcome to <|PROJECT:-MyProject|>!

# If NAME is not set, uses "Anonymous"
# If PROJECT is not set, uses "MyProject"
```

### Date and Time Variables
```bash
# Automatic date/time variables
Generated on <|DATE|> at <|TIME|>
Year: <|YEAR|>

# Result: Generated on 04.09.2025 at 17:15:30
#        Year: 2025
```

### Filename Expansion
```bash
# Filename template: <|PROJECT|>_config.txt
# With PROJECT="MyApp" becomes: MyApp_config.txt
```

## Output Format

The command generates files with substituted content. If output is `-`, content is written to stdout.

## How It Works

1. **Template Reading**: Reads the template file or directory
2. **Variable Collection**: Gathers environment variables for substitution
3. **Sed Generation**: Creates sed expressions for <|KEY|> replacement
4. **File Processing**: Applies substitutions to content and filenames
5. **Output Creation**: Writes the processed content to output files

## Use Cases

### Configuration File Generation
```bash
# Generate nginx config
export SERVER_NAME="example.com"
export PORT="8080"
mulle-template generate nginx.template.conf /etc/nginx/sites-available/example.conf
```

### Source Code Templates
```bash
# Generate class files
export CLASS_NAME="UserManager"
export AUTHOR="John Doe"
mulle-template generate class_template.java UserManager.java
```

### Build Script Automation
```bash
# Generate build scripts
export PROJECT_NAME="MyProject"
export VERSION="1.0.0"
mulle-template generate build_script.sh.template build_script.sh
chmod +x build_script.sh
```

### Multi-Environment Deployment
```bash
# Development environment
export ENV="dev"
export DB_HOST="localhost"
mulle-template generate config.template.json config.dev.json

# Production environment
export ENV="prod"
export DB_HOST="prod-db.example.com"
mulle-template generate config.template.json config.prod.json
```

## Troubleshooting

### Template Not Found
```bash
# Check if template exists
ls -la template.txt

# Use absolute path
mulle-template generate /full/path/to/template.txt output.txt
```

### Variables Not Substituted
```bash
# Check variable is set
echo $VARIABLE_NAME

# Use boring-environment to include all variables
mulle-template generate --boring-environment template.txt output.txt

# Debug with stdout output
mulle-template generate template.txt -
```

### Permission Issues
```bash
# Copy permissions from template
mulle-template generate --permissions template.txt output.txt

# Check output file permissions
ls -la output.txt
```

### Directory Processing Issues
```bash
# Process only specific file in directory
mulle-template generate --file config.txt template_dir/ output_dir/

# Include template directory in output path
mulle-template generate --with-template-dir template_dir/ output/
```

## See Also

- [`list`](list.md) - List variables contained in template files
- [`csed`](csed.md) - Apply content sed operations
- [`fsed`](fsed.md) - Apply filename sed operations